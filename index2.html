<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Genesys Cloud Adoption Metrics</title>

  <!--#region Stylesheets -->

  <!-- Custom fonts-->
  <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">

  <!-- Open Layers -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.1.1/css/ol.css" type="text/css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css">

  <!-- Custom styles for this template-->
  <link href="css/sb-admin-2.min.css" rel="stylesheet">

  <!-- Progress bars with percentage -->
  <link rel="stylesheet" href="css/circle.css">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

  <!-- Bootstrap Date Picker -->
  <link rel="stylesheet" href="vendor/bootstrap-datepicker/dist/css/bootstrap-datepicker3.standalone.min.css">

  <!-- jQuery Toast -->
  <link rel="stylesheet" href="css/jquery.toast.min.css">

  <!-- Custom styles -->
  <link rel="stylesheet" href="css/main.css">

  <!--#endregion -->

</head>


<body id="page-top">

  <div id="fadeMe" style="display:none">
    <div class="spinner"></div>
    <div class="spinner-text" id="spinner-text"></div>
  </div>

  <!-- Page Wrapper -->
  <div id="wrapper">

    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">

      <!-- Main Content -->
      <div id="content">

        <!-- Begin Page Content -->
        <div id="printContent" class="container-fluid mt-4">

          <!-- Page Heading -->
          <div class="mb-4">
            <h1 id="title" class="h3 mb-0 text-gray-800">Genesys Cloud Adoption Metrics</h1>
            <div class="row ml-0 mt-2">
              <button class="btn btn-sm btn-primary shadow-sm" data-toggle="modal" data-target="#configModal"><i class="fas fa-sync-alt fa-sm text-white-50"></i> Get Data</button>
              <button href="#" id="generateReport" class="ml-2 d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"><i class="fas fa-download fa-sm text-white-50"></i> Print Report</button>
            </div>
          </div>

          <!-- Configuration Modal -->
          <div class="modal fade" id="configModal" tabindex="-1" role="dialog" aria-labelledby="configModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="configModalLabel">Configuration</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <form>
                    <div class="form-group">
                      <label for="clientId" class="col-form-label">OAuth Client Id:</label>
                      <input type="text" class="form-control" id="clientId" value="a49ab989-0802-40a6-8c95-da1b6a44ecf0">
                    </div>
                    <div class="form-group">
                      <label for="clientSecret" class="col-form-label">OAuth Client Secret:</label>
                      <input type="password" class="form-control" id="clientSecret" value="4p5mgg6ooH80DNqRj2Xro51VtO87YyhgBe323TaVIVk">
                    </div>
                    <div class="form-group">
                      <label for="environment" class="col-form-label">PureCloud Environment:</label>
                      <input type="text" class="form-control" id="environment" placeholder="e.g. mypurecloud.ie" value="mypurecloud.ie">
                    </div>
                    <div class="form-group">
                      <label for="startDatePicker" class="col-form-label">Start Date:</label>
                      <input type="text" class="form-control" id="startDatePicker" value="2019-12-17T00:00:00.000Z">
                    </div>
                    <div class="form-group">
                      <label for="endDatePicker" class="col-form-label">End Date:</label>
                      <input type="text" class="form-control" id="endDatePicker" value="2019-12-18T00:00:00.000Z">
                    </div>
                  </form>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary pull-left" data-dismiss="modal">Cancel</button>
                  <button type="button" class="btn btn-primary" id="getData">Go!</button>
                </div>
              </div>
            </div>
          </div>

          <div class="row">

            <!-- Licenses (Billable Usage) -->
            <div class="col-xl-3 col-lg-5">
              <div class="card shadow mb-4">
                <div class="card-header py-3">
                  <h6 class="m-0 font-weight-bold text-primary">Licenses Usage</h6>
                  <div class="row ml-0 mt-1 mb-1">
                    <small class="date-range-start text-gray-500"><span class="startDate">yyyy/mm/dd</span> to <span class="endDate">yyyy/mm/dd</span></small>
                  </div>
                </div>
                <div class="card-body">
                  <div class="table-responsive">
                    <table class="table table-bordered" width="100%" cellspacing="0">
                      <thead>
                        <tr>
                          <th>Name</th>
                          <th>Count</th>
                        </tr>
                      </thead>
                      <tbody id="billableUsageBody">
                      </tbody>
                    </table>
                    <small id="licensingLevel" class="text-muted"></small>
                  </div>
                </div>
              </div>
            </div>

            <!-- Licenses Guide -->
            <div class="col-xl-9 col-lg-7">
              <div class="card shadow mb-4">
                <div class="card-header py-3">
                  <h6 class="m-0 font-weight-bold text-primary">Licenses Guide</h6>
                  <div class="row ml-0 mt-1 mb-1">
                    <small class="date-range-start text-gray-500">Taken from <a href="https://www.genesys.com/platform/purecloud/purecloud-pricing" target="_blank">https://www.genesys.com/platform/purecloud/purecloud-pricing</a></small>
                  </div>
                </div>
                <div class="card-body">
                  <div class="panel-group" id="licensesGuideBody" role="tablist" aria-multiselectable="true">
                    Click on "Get Data" to get started
                  </div>
                </div>
              </div>
            </div>

          </div>
          <!-- End of Main Content -->

          <!-- Footer -->
          <footer class="sticky-footer bg-white">
            <div class="container my-auto">
              <div class="copyright text-center my-auto">
                <span>Copyright &copy; Genesys 2020</span>
              </div>
            </div>
          </footer>
          <!-- End of Footer -->

        </div>
        <!-- End of Content Wrapper -->

      </div>
      <!-- End of Page Wrapper -->

      <!-- Scroll to Top Button-->
      <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
      </a>

      <!-- #region Imports -->

      <!-- Global site tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-155607114-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-155607114-1');
        gtag('set', { 'user_id': uuidv4() });
      </script>

      <!-- Bootstrap core JavaScript-->
      <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>

      <!-- Core plugin JavaScript-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>

      <!-- Open Layers -->
      <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.1.1/build/ol.js"></script>

      <!-- Chart Library -->
      <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>

      <!-- moment.js -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js" integrity="sha256-4iQZ6BVL4qNKlQ27TExEhBN1HFPvAvAMbFavKKosSWQ=" crossorigin="anonymous"></script>

      <!-- Bootstrap Date Picker -->
      <script src="vendor/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>

      <!-- jQuery Toast -->
      <script src="js/jquery.toast.min.js"></script>

      <script src="js/message.js"></script>

      <!-- #endregion -->

      <script>

        const devMode = false;

        const urlBasePath = devMode ? 'http://localhost:3000' : 'https://spkhldip36.execute-api.eu-central-1.amazonaws.com/dev';
        const webSocketUrl = devMode ? 'ws://localhost:3001' : 'wss://anr7mnvwrg.execute-api.eu-central-1.amazonaws.com/dev';

        var usages = {}, queue = new TimerQueue(), totalTasks = 0, uniqueId = uuidv4();;
        var isUsingPC1 = false, isUsingPC2 = false, isUsingPC3 = false, isUsingCollaborate = false, isUsingCommunicate = false;
        var allDataReceived = false, allMediaDataReceived = false, allFlowDataReceived = false, allRecordingDataReceived = false;

        //#region Panel

        $('.panel-collapse').on('show.bs.collapse', function () {
          $(this).siblings('.panel-heading').addClass('active');
        });

        $('.panel-collapse').on('hide.bs.collapse', function () {
          $(this).siblings('.panel-heading').removeClass('active');
        });

        //#endregion

        //#region Date Pickers & Functions

        $("#startDatePicker").datepicker({
          format: "yyyy-mm-ddT00:00:00.000Z",
          endDate: "+0d",       // No future dates
          autoclose: true,      // Close after selecting date
          weekStart: 1          // weeks start on Mondays
        });

        $("#endDatePicker").datepicker({
          format: "yyyy-mm-ddT00:00:00.000Z",
          endDate: "+0d",       // No future dates
          autoclose: true,      // Close after selecting date
          weekStart: 1          // weeks start on Mondays
        });

        Date.prototype.addDays = function (days) {
          var date = new Date(this.valueOf());
          date.setDate(date.getDate() + days);
          return date;
        }

        function getDates(startDate, stopDate) {
          var dateArray = [];
          var currentDate = startDate;
          while (currentDate < stopDate) {
            var dateRange = {};
            dateRange.startDate = new Date(currentDate).toISOString();
            currentDate = currentDate.addDays(7);
            if (currentDate > stopDate) {
              currentDate = stopDate;
            }
            dateRange.endDate = new Date(currentDate).toISOString();
            dateArray.push(dateRange);
          }
          return dateArray;
        }

        //#endregion

        //#region Configuration Modal

        $('#configModal').on('show.bs.modal', function (event) {
          //$("#configModal #clientId").trigger('focus'); //TODO Not working and causing an issue with DatePicker
        });

        $("#getData").on("click", async (e) => {
          e.preventDefault();

          try {
            console.log('Getting data...');

            let clientId = $("#configModal #clientId").val();
            let clientSecret = $("#configModal #clientSecret").val();
            let environment = $("#configModal #environment").val();
            let startDate = $("#configModal #startDatePicker").val();
            let endDate = $("#configModal #endDatePicker").val();

            if (!clientId || !clientSecret || !environment || !startDate || !endDate) {
              alert('Invalid or missing parameters');
              return;
            }

            // Start/End dates validation
            if (new Date(startDate) >= new Date(endDate)) {
              alert('Make sure the start date is before the end date');
              return;
            }

            // Close the modal
            $('#configModal').modal('toggle')

            // Update date fields
            var d = new Date(startDate);
            var startDateString = ("0" + (d.getMonth() + 1)).slice(-2) + "-" + ("0" + d.getDate()).slice(-2) + "-" + d.getFullYear();
            $(".startDate").text(startDateString);
            var d = new Date(endDate);
            var endDateString = ("0" + (d.getMonth() + 1)).slice(-2) + "-" + ("0" + d.getDate()).slice(-2) + "-" + d.getFullYear();
            $(".endDate").text(endDateString);

            await getData(clientId, clientSecret, environment, startDate, endDate);

          } catch (error) {
            console.error(error);
            alert(error.message);
          }

        });

        //#endregion

        //#region Spinner

        function showSpinner() {
          $("#fadeMe").addClass("fadeMe");
          $("#fadeMe").show();
        }

        function showCardSpinner(cardName) {
          console.log('Show card spinner for:', cardName);
          $("#" + cardName + " #overlay-div").show();
        }

        function hideSpinner(div) {
          $("#fadeMe").removeClass("fadeMe");
          $("#fadeMe").hide();
        }

        function hideCardSpinner(cardName) {
          console.log('Hide card spinner for:', cardName);
          $("#" + cardName + " #overlay-div").hide();
        }

        //#endregion

        //#region Licenses

        var licenses = {
          categories: [
            {
              name: "Graphical Scripting",
              id: "graphical-scripting",
              items: [
                {
                  name: "Ability to Customize Script",
                  id: "ability-to-customize-script",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                },
                {
                  name: "Default Script - Basic Contact Info",
                  id: "default-script-basic-contact-info",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                },
                {
                  name: "Import/Export Scripts",
                  id: "import-export-scripts",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                },
                {
                  name: "Inbound Call Support",
                  id: "inbound-call-support-scripts",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                },
                {
                  name: "Outbound Call Support",
                  id: "outbound-call-support-scripts",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                },
                {
                  name: "URL Screen Pop",
                  id: "url-screen-pop-scripts",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                },
                {
                  name: "Chat",
                  id: "chat-scripts",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                },
                {
                  name: "Email",
                  id: "email-scripts",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                },
                {
                  name: "Messaging - Messaging Platforms",
                  id: "messaging-scripts",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                },
                {
                  name: "Messaging - SMS",
                  id: "sms-scripts",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                },
                {
                  name: "Voice",
                  id: "voice-scripts",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                },
                {
                  name: "Complex Variable Types",
                  id: "complex-variable-types-scripts",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                },
                {
                  name: "Pre-packaged Validations",
                  id: "pre-packaged-validations-scripts",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                },
                {
                  name: "Scripts Error Panel",
                  id: "error-panel-scripts",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                },
                {
                  name: "Templates",
                  id: "templates-scripts",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                },
                {
                  name: "Version Control",
                  id: "version-control-scripts",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "scripts"
                }
              ]
            },
            {
              name: "Integrations",
              id: "integrations",
              items: [
                {
                  name: "Access Control",
                  id: "access-control",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "divisions"
                },
                {
                  name: "Altocloud",
                  id: "integrations-altocloud",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                },
                {
                  name: "Amazon Lex Digital Bots",
                  id: "integrations-lex-digital-bots",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                },
                {
                  name: "Amazon Lex Voicebots",
                  id: "integrations-lex-voice-bots",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                },
                {
                  name: "Click-to-Dial (tel: links)",
                  id: "integrations-click-to-dial-tel-links",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                },
                {
                  name: "Make Call from Context Menu",
                  id: "integrations-make-call-from-context-menu",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                },
                {
                  name: "PureCloud UI Embedded in Browser Extension",
                  id: "integrations-ui-embedded-in-browser-extension",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                },
                {
                  name: "Screen Pops",
                  id: "integrations-screen-pops",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                },
                {
                  name: "Call Logging",
                  id: "integrations-call-logging",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                },
                {
                  name: "Click-to-Dial",
                  id: "integrations-click-to-dial",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                },
                {
                  name: "PureCloud UI Embedded in Salesforce",
                  id: "integrations-ui-embedded-in-salesforce",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                },
                {
                  name: "PureCloud UI Embedded in Zendesk",
                  id: "integrations-ui-embedded-in-zendesk",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                },
                {
                  name: "Microsoft Dynamics (Data Actions)",
                  id: "integrations-microsoft-dynamics-data-actions",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                },
                {
                  name: "REST (Access a 3rd Party REST API)",
                  id: "integrations-rest-3rd-party-rest-api",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                },
                {
                  name: "Salesforce (Data Actions)",
                  id: "integrations-salesforce-data-actions",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                },
                {
                  name: "Zendesk (Data Actions)",
                  id: "integrations-zendesk-data-actions",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                },
                {
                  name: "Skype for Business",
                  id: "integrations-skype-for-business",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "integrations"
                }
              ]
            },
            {
              name: "Omnichannel Routing",
              id: "omnichannel-routing",
              items: [
                {
                  name: "ACD Voicemail Routing",
                  id: "acd-voicemail-routing",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Bullseye Routing",
                  id: "bullseye-routing",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Callbacks (IVR & Web)",
                  id: "callbacks-ivr-and-web",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Canned Responses",
                  id: "canned-responses",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Customer Journey",
                  id: "customer-journey",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Email",
                  id: "email",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "External Contacts",
                  id: "external-contacts",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Inbound Messaging (WhatsApp)",
                  id: "inbound-messaging-whatsapp",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "In-Queue Audio Configuration",
                  id: "inqueue-audio-configuration",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Inbound Messaging (Facebook Messaging, Twitter Direct Message, Line)",
                  id: "inbound-messaging-others",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Preferred Agent Routing",
                  id: "preferred-agent-routing",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Priority, FIFO Routing",
                  id: "priority-fifo-routing",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Skills-based Routing",
                  id: "skills-based-routing",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "SMS Inbound",
                  id: "sms-inbound",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "SMS Outbound (On-behalf of Queue)",
                  id: "sms-outbound-on-behalf-of-queue",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Voice",
                  id: "voice",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Voice Co-browse",
                  id: "voice-co-browse",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Voice Screenshare",
                  id: "voice-screen-share",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Web Chat",
                  id: "webchat",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Web Chat Co-browse",
                  id: "webchat-co-browse",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Web Chat Screenshare",
                  id: "webchat-screen-share",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
                {
                  name: "Wrap-up Codes",
                  id: "wrap-up-codes",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "omnichannel-routing"
                },
              ]
            },
            {
              name: "Outbound Campaigns",
              id: "outbound-campaigns",
              items: [
                {
                  name: "Abandon Rate Configuration",
                  id: "abandon-rate-configuration",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-campaigns"
                },
                {
                  name: "Caller ID Control",
                  id: "caller-id-control",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-campaigns"
                },
                {
                  name: "Campaign Sequences",
                  id: "campaign-sequences",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-campaigns"
                },
                {
                  name: "Filtering for Call Lists",
                  id: "filtering-for-call-lists",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-campaigns"
                },
                {
                  name: "Multi-level Caller ID Settings",
                  id: "multi-level-caller-id-settings",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-campaigns"
                },
                {
                  name: "Outlook-Style Schedule View",
                  id: "outlook-style-schedule-view",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-campaigns"
                },
                {
                  name: "Progress View",
                  id: "progress-view",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-campaigns"
                },
                {
                  name: "Callable Times",
                  id: "callable-times",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-campaigns"
                },
                {
                  name: "Dynamic Do Not Call Lists",
                  id: "dynamic-do-not-call-lists",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-campaigns"
                },
                {
                  name: "Multiple DNC Lists per Campaign",
                  id: "multiple-dnc-lists-per-campaign",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-campaigns"
                },
                {
                  name: "Online DNC.com Integration",
                  id: "online-dnc.com-integration",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-campaigns"
                },
                {
                  name: "Pacing Control and Overrides",
                  id: "pacing-control-and-overrides",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-campaigns"
                },
                {
                  name: "Time Zone Mapping; Automatic for North America",
                  id: "time-zone-mapping",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-campaigns"
                },
                {
                  name: "Time Zone Support",
                  id: "time-zone-support",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-campaigns"
                }
              ]
            },
            {
              name: "Outbound Dialing",
              id: "outbound-dialing",
              items: [
                {
                  name: "Advanced Record Processing Rules",
                  id: "advanced-record-processing-rules",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-dialing"
                },
                {
                  name: "Agentless / Auto-messaging",
                  id: "agentless-auto-messaging",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-dialing"
                },
                {
                  name: "Answering Machine Detection",
                  id: "answering-machine-detection",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-dialing"
                },
                {
                  name: "Contact List Management",
                  id: "contact-list-management",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-dialing"
                },
                {
                  name: "Contact List Rest API",
                  id: "contact-list-rest-api",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-dialing"
                },
                {
                  name: "Data Export",
                  id: "data-export",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-dialing"
                },
                {
                  name: "Inbound / Outbound Blending",
                  id: "inbound-outbound-blending",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-dialing"
                },
                {
                  name: "Outbound Reports",
                  id: "outbound-reports",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-dialing"
                },
                {
                  name: "Power",
                  id: "power",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-dialing"
                },
                {
                  name: "Predictive",
                  id: "predictive",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-dialing"
                },
                {
                  name: "Preview",
                  id: "preview",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-dialing"
                },
                {
                  name: "Priority Preview",
                  id: "priority-preview",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-dialing"
                },
                {
                  name: "Progressive",
                  id: "progressive",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-dialing"
                },
                {
                  name: "Scheduled Callbacks",
                  id: "scheduled-callbacks",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-dialing"
                },
                {
                  name: "Wrap-up Codes",
                  id: "wrap-up-codes",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "outbound-dialing"
                }
              ]
            },
            {
              name: "Reporting and Analytics",
              id: "reporting-and-analytics",
              items: [
                {
                  name: "Access to Custom Statistics and Views through Flexible API",
                  id: "access-to-custom-statistics",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Alerts",
                  id: "alerts",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Contact Center Dashboard",
                  id: "contact-center-dashboard",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Export Dynamic Views",
                  id: "export-dynamic-views",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Flow Performance Views Overview",
                  id: "flow-performance-views-overview",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Interactions View",
                  id: "interactions-view",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Intraday Monitoring and Schedule Adherence Views",
                  id: "intraday-monitoring-and-schedule-adherence-views",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "My Performance and My Queue Activity (Formerly Agent Dashboard)",
                  id: "my-performance-and-my-queue-activity",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Performance Dashboards",
                  id: "performance-dashboards",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Queues Activity Real-Time Views",
                  id: "queues-activity-real-time-views",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Queues and Agents Performance View",
                  id: "queues-and-agents-performance-view",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Skills, Wrap-up, DNIS Views",
                  id: "skills-wrap-up-dnis-views",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Agent Activity Summary Report",
                  id: "agent-activity-summary-report",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Interaction Details",
                  id: "interaction-details",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Queue Metrics",
                  id: "queue-metrics",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Queue Wrapup Summary Report",
                  id: "queue-wrapup-summary-report",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Scheduled Reports",
                  id: "scheduled-reports",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Listen",
                  id: "listen",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Locator Search",
                  id: "locator-search",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                },
                {
                  name: "Real-time Dashboard",
                  id: "real-time-dashboard",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "reporting-and-analytics"
                }
              ]
            },
            {
              name: "Security and Compliance",
              id: "security-and-compliance",
              items: [
                {
                  name: "CCPA",
                  id: "ccpa",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "security-and-compliance"
                },
                {
                  name: "GDPR",
                  id: "gdpr",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "security-and-compliance"
                },
                {
                  name: "HIPAA Compliance",
                  id: "hipaa-compliance",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "security-and-compliance"
                },
                {
                  name: "PCI DSS (with Secure IVR)",
                  id: "pci-dss-with-secure-ivr",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "security-and-compliance"
                },
                {
                  name: "PCI DSS (with Secure Pause)",
                  id: "pci-dss-with-secure-pause",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "security-and-compliance"
                }
              ]
            },
            {
              name: "Speech-Enabled IVR",
              id: "speech-enabled-ivr",
              items: [
                {
                  name: "Automatic Speech Recognition (ASR)",
                  id: "automatic-speech-recognition",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
                {
                  name: "Audio Debug a Call Flow (English)",
                  id: "audio-debug-a-call-flow-english",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
                {
                  name: "Dependency Tracking",
                  id: "dependency-tracking",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
                {
                  name: "Drag & Drop Auto-Attendant",
                  id: "drag-and-drop-auto-attendant",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
                {
                  name: "Email Flows",
                  id: "email-flows",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
                {
                  name: "Graphical Text Editor",
                  id: "graphical-text-editor",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
                {
                  name: "Inbound Call Flows",
                  id: "inbound-call-flows",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
                {
                  name: "Integrated Prompt Management",
                  id: "integrated-prompt-management",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
                {
                  name: "Integrated Speech Enablement",
                  id: "integrated-speech-enablement",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
                {
                  name: "Native Versioning",
                  id: "native-versioning",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
                {
                  name: "Outbound Call Flows",
                  id: "outbound-call-flows",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
                {
                  name: "Printing a Call Flow",
                  id: "printing-a-call-flow",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
                {
                  name: "Real-time Error Tracking",
                  id: "real-time-error-tracking",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
                {
                  name: "Robust Expression Editing",
                  id: "robust-expression-editing",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
                {
                  name: "Secure IVR",
                  id: "secure-ivr",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
                {
                  name: "Text-to-Speech (TTS)",
                  id: "text-to-speech",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "speech-enabled-ivr"
                },
              ]
            },
            {
              name: "Workforce Optimization",
              id: "workforce-optimization",
              items: [
                {
                  name: "Agent, Evaluator, and Supervisor Access - Recordings and Evaluation Scores",
                  id: "agent-evaluator-and-supervisor-access",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Calibration Process",
                  id: "calibration-process",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Evaluation Assignment",
                  id: "evaluation-assignment",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Evaluation Assignment - Per Agent per Time Period",
                  id: "evaluation-assignment-per-agent-per-time-period",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Evaluation Form Designer",
                  id: "evaluation-form-designer",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Evaluation Notifications",
                  id: "evaluation-notifications",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Faceted Evaluation Search",
                  id: "faceted-evaluation-search",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Multiple Question Types: Yes/no, Multiple Choice, Critical, and Fatal",
                  id: "multiple-question-types",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "100% Email Recording",
                  id: "100-email-recording",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "100% Encryption",
                  id: "100-encryption",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "100% Voice Recording",
                  id: "100-voice-recording",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "100% Web Chat Recording",
                  id: "100-web-chat-recording",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Bulk Delete",
                  id: "bulk-delete",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Callback",
                  id: "callback",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Dual-channel Call Recording",
                  id: "dual-channel-call-recording",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Evaluation Audit Trail",
                  id: "evaluation-audit-trail",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Flexible Search with Facets",
                  id: "flexible-search-with-facets",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Long-term Cloud Storage",
                  id: "long-term-cloud-storage",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Messaging",
                  id: "messaging",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Permission-based Playback Access",
                  id: "permission-based-playback-access",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Policy-based Recording Retention",
                  id: "policy-based-recording-retention",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Recording Audit Trail",
                  id: "recording-audit-trail",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Screen Recordings",
                  id: "screen-recordings",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Secure Pause",
                  id: "secure-pause",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Single-channel Call Recording",
                  id: "single-channel-call-recording",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "SMS",
                  id: "sms",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Survey Views",
                  id: "survey-views",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Multi-channel Post Interaction Web based Surveys",
                  id: "multi-channel-post-interaction-web-based-surveys",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Speech-to-Text Transcription (3rd Party)",
                  id: "speech-to-text-transcription-3rd-party",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Agent Activation",
                  id: "agent-activation",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Listen (Monitoring)",
                  id: "listen-monitoring",
                  PureCloud1: true,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Historical Schedule Adherence",
                  id: "historical-schedule-adherence",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Intraday Monitoring",
                  id: "intraday-monitoring",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Intraday Rescheduling",
                  id: "intraday-rescheduling",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Load-Based Schedule Generation",
                  id: "load-based-schedule-generation",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Manual Schedule Creation",
                  id: "manual-schedule-creation",
                  PureCloud1: false,
                  PureCloud2: true,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Real-Time Schedule Adherence",
                  id: "real-time-schedule-adherence",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Shift Trading",
                  id: "shift-trading",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Short-Term Forecasting",
                  id: "short-term-forecasting",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
                {
                  name: "Time Off Requests",
                  id: "time-off-requests",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: true,
                  Collaborate: false,
                  Communicate: false,
                  mappingItem: "workforce-optimization"
                },
              ]
            },
            {
              name: "Collaboration and Communication",
              id: "collaboration-and-communication",
              items: [
                {
                  name: "Audio Conferencing",
                  id: "audio-conferencing",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: false,
                  Collaborate: false,
                  Communicate: true,
                  mappingItem: "collaboration-and-communication"
                },
                {
                  name: "Call Recording",
                  id: "call-recording",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: false,
                  Collaborate: false,
                  Communicate: true,
                  mappingItem: "collaboration-and-communication"
                },
                {
                  name: "Chat",
                  id: "chat",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: false,
                  Collaborate: true,
                  Communicate: true,
                  mappingItem: "collaboration-and-communication"
                },
                {
                  name: "Cloud IP PBX",
                  id: "cloud-ip-pbx",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: false,
                  Collaborate: false,
                  Communicate: true,
                  mappingItem: "collaboration-and-communication"
                },
                {
                  name: "Desktop Sharing",
                  id: "desktop-sharing",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: false,
                  Collaborate: true,
                  Communicate: true,
                  mappingItem: "collaboration-and-communication"
                },
                {
                  name: "Directory",
                  id: "directory",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: false,
                  Collaborate: true,
                  Communicate: true,
                  mappingItem: "collaboration-and-communication"
                },
                {
                  name: "File Sharing",
                  id: "file-sharing",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: false,
                  Collaborate: true,
                  Communicate: true,
                  mappingItem: "collaboration-and-communication"
                },
                {
                  name: "Group Ring, Hunt Groups",
                  id: "group-ring-hunt-groups",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: false,
                  Collaborate: false,
                  Communicate: true,
                  mappingItem: "collaboration-and-communication"
                },
                {
                  name: "Inbound & Outbound Faxing",
                  id: "inbound-outbound-faxing",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: false,
                  Collaborate: false,
                  Communicate: true,
                  mappingItem: "collaboration-and-communication"
                },
                {
                  name: "Native Mobile Application",
                  id: "native-mobile-application",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: false,
                  Collaborate: true,
                  Communicate: true,
                  mappingItem: "collaboration-and-communication"
                },
                {
                  name: "Unified Inbox",
                  id: "unified-inbox",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: false,
                  Collaborate: false,
                  Communicate: true,
                  mappingItem: "collaboration-and-communication"
                },
                {
                  name: "Video Callling - Peer-to-peer",
                  id: "video-calling-peer-to-peer",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: false,
                  Collaborate: true,
                  Communicate: true,
                  mappingItem: "collaboration-and-communication"
                },
                {
                  name: "Video Callling - Multi-user",
                  id: "video-calling-multi-user",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: false,
                  Collaborate: false,
                  Communicate: true,
                  mappingItem: "collaboration-and-communication"
                },
                {
                  name: "Voicemail",
                  id: "voicemail",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: false,
                  Collaborate: false,
                  Communicate: true,
                  mappingItem: "collaboration-and-communication"
                },
                {
                  name: "WebRTC Softphone",
                  id: "webrtc-softphone",
                  PureCloud1: false,
                  PureCloud2: false,
                  PureCloud3: false,
                  Collaborate: false,
                  Communicate: true,
                  mappingItem: "collaboration-and-communication"
                },
              ]
            }
          ]
        };

        function setLicensingLevel(license) {
          switch (license) {
            case 'PureCloud 1 User Usage':
              isUsingPC1 = true;
              isUsingCollaborate = true;
              isUsingCommunicate = true;
              break;
            case 'PureCloud 2 User Usage':
            case 'PureCloud 2 Concurrent User Usage':
              isUsingPC2 = true;
              isUsingCollaborate = true;
              isUsingCommunicate = true;
              break;
            case 'PureCloud 3 User Usage':
              isUsingPC3 = true;
              isUsingCollaborate = true;
              isUsingCommunicate = true;
              break;
            case 'PureCloud Communicate User Usage':
              isUsingCommunicate = true;
              break;
            case 'PureCloud Collaborate User Usage':
              isUsingCollaborate = true;
              break;
            default:
              break;
          }
          $("#licensingLevel").html(`PureCloud1: ${isUsingPC1}<br>PureCloud2: ${isUsingPC2}<br>PureCloud3: ${isUsingPC3}<br>Collaborate: ${isUsingCollaborate}<br>Communicate: ${isUsingCommunicate}`);
        }

        function populateLicenses(clientId, clientSecret, environment) {
          $.each(licenses.categories, (i, category) => {

            // Accordion
            let divPanel = $("<div/>", { class: "panel panel-primary", id: category.id }).appendTo("#licensesGuideBody")

            // Title
            //$("<h4/>", { class: "text-center mb-3 text-gray-800" }).text(category.name).appendTo("#licensesGuideBody");
            let panelHeading = $("<div/>", { class: "panel-heading", role: "tab", id: "heading-" + category.id }).appendTo(divPanel);
            let panelTitle = $("<h4/>", { class: "panel-title" }).appendTo(panelHeading);
            $("<a/>", { role: "button", "data-toggle": "collapse", "data-parent": "#licensesGuideBody", href: "#collapse-" + category.id, "aria-expanded": "true", "aria-controls": "collapse-" + category.id }).text(category.name).appendTo(panelTitle);

            let collapseDiv = $("<div/>", { id: "collapse-" + category.id, class: "panel-collapse collapse in", role: "tabpanel", "aria-labelledby": "heading-" + category.id }).appendTo(divPanel);
            let contentDiv = $("<div/>", { class: "panel-body" }).appendTo(collapseDiv);

            // Table
            //let categoryTableDiv = $("<div/>", { id: "category-" + category.id, class: "table-responsive" }).appendTo("#licensesGuideBody");
            let categoryTableDiv = $("<div/>", { id: "category-" + category.id, class: "table-responsive" }).appendTo(contentDiv);

            //#region Table Headers

            let table = $("<table/>", { class: "table table-bordered table-hover", width: "100%", cellspacing: "0" }).appendTo(categoryTableDiv);
            let thead = $("<thead/>").appendTo(table);
            let theadRow = $("<tr/>").appendTo(thead);
            $("<th/>", { class: "text-center" }).appendTo(theadRow);

            let categoryHasPureCloud1Items = category.items.filter(i => i.PureCloud1).length > 0;
            let categoryHasPureCloud2Items = category.items.filter(i => i.PureCloud2).length > 0;
            let categoryHasPureCloud3Items = category.items.filter(i => i.PureCloud3).length > 0;
            let categoryHasPureCloudCollaborateItems = category.items.filter(i => i.Collaborate).length > 0;
            let categoryHasPureCloudCommunicateItems = category.items.filter(i => i.Communicate).length > 0;

            if (categoryHasPureCloud1Items) { $("<th/>", { class: "text-center " + (isUsingPC1 ? "text-white bg-success" : "") }).text("PureCloud 1").appendTo(theadRow); }
            if (categoryHasPureCloud2Items) { $("<th/>", { class: "text-center " + (isUsingPC2 ? "text-white bg-success" : "") }).text("PureCloud 2").appendTo(theadRow); }
            if (categoryHasPureCloud3Items) { $("<th/>", { class: "text-center " + (isUsingPC3 ? "text-white bg-success" : "") }).text("PureCloud 3").appendTo(theadRow); }
            if (categoryHasPureCloudCollaborateItems) { $("<th/>", { class: "text-center " + (isUsingCollaborate ? "text-white bg-success" : "") }).text("Collaborate").appendTo(theadRow); }
            if (categoryHasPureCloudCommunicateItems) { $("<th/>", { class: "text-center " + (isUsingCommunicate ? "text-white bg-success" : "") }).text("Communicate").appendTo(theadRow); }

            $("<th/>", { class: "text-center" }).text("Current State").appendTo(theadRow);

            //#endregion

            let tbody = $("<tbody/>", { id: "tbody-" + category.id }).appendTo(table);

            // Populate items
            $.each(category.items, async (i, item) => {
              //#region License Levels

              let row = $("<tr/>", { id: item.id }).appendTo(tbody);
              $("<td/>", { class: "text-center" }).text(item.name).appendTo(row);
              if (categoryHasPureCloud1Items) { $("<td/>", { class: "text-center" }).html(item.PureCloud1 ? '<i class="fas fa-check"></i>' : "").appendTo(row) };
              if (categoryHasPureCloud2Items) { $("<td/>", { class: "text-center" }).html(item.PureCloud2 ? '<i class="fas fa-check"></i>' : "").appendTo(row) };
              if (categoryHasPureCloud3Items) { $("<td/>", { class: "text-center" }).html(item.PureCloud3 ? '<i class="fas fa-check"></i>' : "").appendTo(row) };
              if (categoryHasPureCloudCollaborateItems) { $("<td/>", { class: "text-center" }).html(item.Collaborate ? '<i class="fas fa-check"></i>' : "").appendTo(row) };
              if (categoryHasPureCloudCommunicateItems) { $("<td/>", { class: "text-center" }).html(item.Communicate ? '<i class="fas fa-check"></i>' : "").appendTo(row) };

              //#endregion

              // Check actual usage
              switch (item.mappingItem) {
                case "divisions":
                  $("<td/>", { class: "text-center" }).text(usages.divisions + " divisions").appendTo(row);
                  if (usages.divisions > 1) { // There is always one division called "Home" by default
                    row.addClass('text-success');
                  }
                  else if ((isUsingPC1 && item.PureCloud1) || (isUsingPC2 && item.PureCloud2) || (isUsingPC3 && item.PureCloud3) || (isUsingCollaborate && item.Collaborate) || (isUsingCommunicate && item.Communicate)) {
                    row.addClass('text-danger');
                  }
                  break;
                case "scripts":
                  let allFlowsWithScripts = [];
                  if (usages.flows.length > 0) {
                    allFlowsWithScripts = usages.flows.filter(f => {
                      if (f.uiMetaData.hasOwnProperty('scripts') && f.uiMetaData.scripts.length > 0) { return f } else return;
                    });
                  }
                  let commentsCol = undefined, queuesWithScripts = 0;
                  switch (item.id) {
                    case 'inbound-call-support-scripts':
                      let allInboundFlowsWithScripts = allFlowsWithScripts.filter(f => f.type === 'inboundcall');
                      allInboundFlowsWithScripts.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      commentsCol = $("<td/>", { class: "text-center" }).text(allInboundFlowsWithScripts.length + " inbound flow(s) with scripts").appendTo(row);
                      // Are there queues with default scripts?
                      queuesWithScripts = usages.queues.filter(q => q.hasOwnProperty('defaultScripts') && Object.entries(q.defaultScripts).length > 0);
                      if (queuesWithScripts.length > 0) {
                        commentsCol.html(`${commentsCol.text()}<br>${queuesWithScripts.length} queue(s) with a default script`);
                      }
                      break;
                    case 'outbound-call-support-scripts':
                      let allOutboundFlowsWithScripts = allFlowsWithScripts.filter(f => f.type === 'outboundcall');
                      // Are there queues with default scripts?
                      queuesWithScripts = usages.queues.filter(q => q.hasOwnProperty('defaultScripts') && Object.entries(q.defaultScripts).length > 0);
                      (allOutboundFlowsWithScripts.length + queuesWithScripts.length) > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).html(`${allOutboundFlowsWithScripts.length} outbound flow(s) with scripts<br>${queuesWithScripts.length} queue(s) with default scripts`).appendTo(row);
                      break;
                    case 'url-screen-pop-scripts':
                      let scriptsWithUrlScreenPops = usages.scripts.filter(s => s.hasOwnProperty('customActions') && s.customActions.length > 0 && s.customActions.filter(ca => ca.action.block.filter(b => b.actionName === 'scripter.webPage')).length > 0);
                      scriptsWithUrlScreenPops.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      commentsCol = $("<td/>", { class: "text-center" }).text(scriptsWithUrlScreenPops.length + " script(s) with URL Screen Pops").appendTo(row);
                      break;
                    case 'chat-scripts':
                      let scriptsUsedWithChat = usages.scripts.filter(s => s.hasOwnProperty('features') && s.features.length > 0 && s.features.filter(f => f.chat.properties.enabled.value === true).length > 0);
                      scriptsUsedWithChat.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      commentsCol = $("<td/>", { class: "text-center" }).text(scriptsUsedWithChat.length + " script(s) used for Chats").appendTo(row);
                      break;
                    case 'email-scripts':
                      let scriptsUsedWithEmail = usages.scripts.filter(s => s.hasOwnProperty('features') && s.features.length > 0 && s.features.filter(f => f.email.properties.enabled.value === true).length > 0);
                      scriptsUsedWithEmail.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      commentsCol = $("<td/>", { class: "text-center" }).text(scriptsUsedWithEmail.length + " script(s) used for Emails").appendTo(row);
                      break;
                    case 'messaging-scripts':
                      let scriptsUsedWithMessaging = usages.scripts.filter(s => s.hasOwnProperty('features') && s.features.length > 0 && s.features.filter(f => f.message.properties.enabled.value === true).length > 0);
                      scriptsUsedWithMessaging.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      commentsCol = $("<td/>", { class: "text-center" }).text(scriptsUsedWithMessaging.length + " script(s) used for Emails").appendTo(row);
                      break;
                    case 'sms-scripts':
                      //Don't know how to find that out
                      commentsCol = $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'voice-scripts':
                      let scriptsUsedWithVoice = usages.scripts;
                      scriptsUsedWithVoice.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      commentsCol = $("<td/>", { class: "text-center" }).text(scriptsUsedWithVoice.length + " script(s) can be used for Voice").appendTo(row);
                      break;
                    case 'complex-variable-types-scripts':
                      //Don't know what this is
                      commentsCol = $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'pre-packaged-validations-scripts':
                      //Don't know what this is
                      commentsCol = $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'error-panel-scripts':
                      //Can't really find out whether this is used or not
                      commentsCol = $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'templates-scripts':
                      //No APIs to list templates
                      commentsCol = $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'version-control-scripts':
                      //No APIs to get multiple versions of a script
                      commentsCol = $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    default:
                      commentsCol = $("<td/>", { class: "text-center" }).text(usages.scripts.length + " script(s)").appendTo(row);
                      if (usages.scripts.length > 0) {
                        row.addClass('text-success');
                      }
                      else if ((isUsingPC1 && item.PureCloud1) || (isUsingPC2 && item.PureCloud2) || (isUsingPC3 && item.PureCloud3) || (isUsingCollaborate && item.Collaborate) || (isUsingCommunicate && item.Communicate)) {
                        row.addClass('text-danger');
                      }
                      break;
                  }
                  break;
                case "integrations":
                  switch (item.id) {
                    case 'integrations-altocloud':
                      let hasAltocloudLicenses = usages.licenses.hasOwnProperty('PureCloud for Altocloud') ? usages.licenses['PureCloud for Altocloud'] : 0;
                      hasAltocloudLicenses > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(hasAltocloudLicenses + " user(s) with an Altocloud license").appendTo(row);
                      break;
                    case 'integrations-lex-digital-bots':
                      let chatFlowsUsingLex = usages.flows.filter(f => f.type === 'inboundchat' && f.manifest.hasOwnProperty('lexBot') && f.manifest.lexBot.length > 0).length;
                      console.log('Chat flows using lex:', chatFlowsUsingLex);
                      chatFlowsUsingLex > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(chatFlowsUsingLex + " chat flow(s) with Lex bots").appendTo(row);
                      break;
                    case 'integrations-lex-voice-bots':
                      let voiceFlowsUsingLex = usages.flows.filter(f => (f.type === 'inboundcall' || f.type === 'securecall') && f.manifest.hasOwnProperty('lexBot') && f.manifest.lexBot.length > 0).length;
                      voiceFlowsUsingLex > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(voiceFlowsUsingLex + " voice flow(s) with Lex bots").appendTo(row);
                      break;
                    case 'integrations-click-to-dial-tel-links':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'integrations-make-call-from-context-menu':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'integrations-ui-embedded-in-browser-extension':
                      let embeddableFrameworkApps = usages.integrations.hasOwnProperty('embedded-client-app') ? usages.integrations['embedded-client-app'] : 0;
                      embeddableFrameworkApps > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(embeddableFrameworkApps + " embedded client app(s)").appendTo(row);
                      break;
                    case 'integrations-screen-pops':
                      let scriptsWithUrlScreenPops = usages.scripts.filter(s => s.hasOwnProperty('customActions') && s.customActions.length > 0 && s.customActions.filter(ca => ca.action.block.filter(b => b.actionName === 'scripter.webPage')).length > 0);
                      scriptsWithUrlScreenPops.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      let flowsWithScreenPops = usages.flows.filter(f => f.uiMetaData.hasOwnProperty('screenPops') && f.uiMetaData.screenPops.length > 0);
                      let screenPopsTd = $("<td/>", { class: "text-center" }).text(scriptsWithUrlScreenPops.length + " script(s) with URL Screen Pops").appendTo(row);
                      let scriptsInFlowsWithScreenPops = usages.flows.filter(f => f.uiMetaData.hasOwnProperty('scripts') && f.uiMetaData.scripts.length > 0 && f.uiMetaData.scripts.filter(s => s.variables.properties.hasOwnProperty('Screen Pop URL')));
                      if (scriptsInFlowsWithScreenPops.length > 0) {
                        screenPopsTd.html(`${screenPopsTd.text()}<br>${scriptsInFlowsWithScreenPops.length} screen pop(s) found in script(s) used in flows`);
                      }
                      break;
                    case 'integrations-call-logging':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'integrations-click-to-dial':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'integrations-ui-embedded-in-salesforce':
                      $("<td/>", { class: "text-center" }).text("N/A (done in Salesforce)").appendTo(row);
                      break;
                    case 'integrations-ui-embedded-in-zendesk':
                      $("<td/>", { class: "text-center" }).text("N/A (done in Zendesk)").appendTo(row);
                      break;
                    case 'integrations-microsoft-dynamics-data-actions':
                      let microsoftDynamicsDataActions = usages.integrations.hasOwnProperty('microsoft-dynamics-data-actions') ? usages.integrations['microsoft-dynamics-data-actions'] : 0;
                      microsoftDynamicsDataActions > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(microsoftDynamicsDataActions + " Microsoft Dynamics Data Action(s)").appendTo(row);
                      break;
                    case 'integrations-rest-3rd-party-rest-api':
                      let customRestActions = usages.integrations.hasOwnProperty('custom-rest-actions') ? usages.integrations['custom-rest-actions'] : 0;
                      customRestActions > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(customRestActions + " Custom REST Action(s)").appendTo(row);
                      break;
                    case 'integrations-salesforce-data-actions':
                      let salesforceDataActions = usages.integrations.hasOwnProperty('salesforce-data-dip') ? usages.integrations['salesforce-data-dip'] : 0;
                      salesforceDataActions > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(salesforceDataActions + " Salesforce Data Action(s)").appendTo(row);
                      break;
                    case 'integrations-zendesk-data-actions':
                      let zendeskDataActions = usages.integrations.hasOwnProperty('zendesk-data-actions') ? usages.integrations['zendesk-data-actions'] : 0;
                      zendeskDataActions > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(zendeskDataActions + " Zendesk Data Action(s)").appendTo(row);
                      break;
                    case 'integrations-skype-for-business':
                      let skypeForBusinessUsage = usages.integrations.hasOwnProperty('skype-for-business-client') ? usages.integrations['skype-for-business-client'] : 0;
                      skypeForBusinessUsage > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(skypeForBusinessUsage + " Skype For Business Client configured").appendTo(row);
                      break;
                    default:
                      break;
                  }
                  break;
                case "omnichannel-routing":
                  switch (item.id) {
                    case 'acd-voicemail-routing':
                      let flowsWithVoicemailRouting = 0;
                      //This is dirty but I failed to use filter for nested subarrays in array
                      usages.flows.forEach((flow) => {
                        flow.flowSequenceItemList.forEach((flowSequenceItem) => {
                          if (flowSequenceItem.hasOwnProperty('actionList')) {
                            flowSequenceItem.actionList.forEach((action) => {
                              if (action.__type == 'TransferVoicemailAction') {
                                flowsWithVoicemailRouting++;
                              }
                            });
                          }
                        });
                      });
                      flowsWithVoicemailRouting > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(flowsWithVoicemailRouting + " flow(s) with ACD Voicemail Routing").appendTo(row);
                      break;
                    case 'bullseye-routing':
                      let queuesWithBullseyeRouting = usages.queues.filter(q => q.hasOwnProperty('bullseye') && q.bullseye.rings.length > 0).length;
                      queuesWithBullseyeRouting > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(queuesWithBullseyeRouting + " queue(s) with Bullseye Routing").appendTo(row);
                      break;
                    case 'callbacks-ivr-and-web':
                      let callbacks = usages.media.callbacks || 0;
                      callbacks > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(callbacks + " callbacks").appendTo(row);
                      break;
                    case 'canned-responses':
                      let cannedLibraries = usages.responseLibraries || 0;
                      cannedLibraries > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(cannedLibraries + " response libraries").appendTo(row);
                      break;
                    case 'customer-journey':
                      //Don't know how to find that out
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'email':
                      let emails = usages.media.emails || 0;
                      emails > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(emails + " emails").appendTo(row);
                      break;
                    case 'external-contacts':
                      let externalContacts = usages.externalContacts || 0;
                      externalContacts > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(externalContacts + " external contacts").appendTo(row);
                      break;
                    case 'inbound-messaging-whatsapp':
                      let whatsAppUsage = usages.media.messages.whatsapp || 0;
                      whatsAppUsage > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(whatsAppUsage + " WhatsApp conversations").appendTo(row);
                      break;
                    case 'inqueue-audio-configuration':
                      let flowsWithInQueueFlows = usages.flows.filter(f => f.type === 'inqueuecall').length || 0;
                      flowsWithInQueueFlows > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(flowsWithInQueueFlows + " In-Queue Flows").appendTo(row);
                      break;
                    case 'inbound-messaging-others':
                      let otherMessagesUsage = (sum(usages.media.messages) - (usages.media.messages.whatsapp || 0)) || 0;
                      otherMessagesUsage > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(otherMessagesUsage + " Messaging Conversations (other than WhatsApp)").appendTo(row);
                      break;
                    case 'preferred-agent-routing':
                      let queuesWithPreferredAgentRouting = usages.queues.filter(q => q.hasOwnProperty('routingRules') && q.routingRules.filter(rr => rr.operator === 'MEETS_THRESHOLD').length > 0).length;
                      queuesWithPreferredAgentRouting > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(queuesWithPreferredAgentRouting + " queue(s) with Preferred Agent Routing").appendTo(row);
                      break;
                    case 'priority-fifo-routing':
                      let flowsWithPriorityRouting = 0;
                      //This is dirty but I failed to use filter for nested subarrays in array
                      usages.flows.forEach((flow) => {
                        flow.flowSequenceItemList.forEach((flowSequenceItem) => {
                          if (flowSequenceItem.hasOwnProperty('actionList')) {
                            flowSequenceItem.actionList.forEach((action) => {
                              if (action.__type == 'TransferPureMatchAction') {
                                if (action.hasOwnProperty('priority') && action.priority.hasOwnProperty('text') && parseInt(action.priority.text) > 0) {
                                  flowsWithPriorityRouting++;
                                }
                              }
                            });
                          }
                        });
                      });
                      flowsWithPriorityRouting > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(flowsWithPriorityRouting + " flow(s) with Priority Routing").appendTo(row);
                      break;
                    case 'skills-based-routing':
                      let flowsWithSkillsBasedRouting = 0;
                      //This is dirty but I failed to use filter for nested subarrays in array
                      usages.flows.forEach((flow) => {
                        flow.flowSequenceItemList.forEach((flowSequenceItem) => {
                          if (flowSequenceItem.hasOwnProperty('actionList')) {
                            flowSequenceItem.actionList.forEach((action) => {
                              if (action.__type == 'TransferPureMatchAction') {
                                if (action.hasOwnProperty('skills') && action.skills.length > 0) {
                                  flowsWithSkillsBasedRouting++;
                                }
                              }
                            });
                          }
                        });
                      });
                      flowsWithSkillsBasedRouting > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(flowsWithSkillsBasedRouting + " flow(s) with Skills-based Routing").appendTo(row);
                      break;
                    case 'sms-inbound':
                      let numberOfInboundSMS = (usages.media.messages.sms ? usages.media.messages.sms.inbound : 0);
                      numberOfInboundSMS > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(numberOfInboundSMS + " inbound SMS").appendTo(row);
                      break;
                    case 'sms-outbound-on-behalf-of-queue':
                      let numberOfOutboundSMS = (usages.media.messages.sms ? usages.media.messages.sms.outbound : 0);
                      numberOfOutboundSMS > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(numberOfOutboundSMS + " outbound SMS").appendTo(row);
                      break;
                    case 'voice':
                      let numberOfCalls = usages.media.calls || 0;
                      numberOfCalls > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(numberOfCalls + " call(s)").appendTo(row);
                      break;
                    case 'voice-co-browse':
                      let numberOfCoBrowse = usages.media.cobrowses || 0;
                      numberOfCoBrowse > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(numberOfCoBrowse + " co-browse session(s) (all channels)").appendTo(row);
                      break;
                    case 'voice-screen-share':
                      let numberOfScreenShares = usages.media.screenshares || 0;
                      numberOfScreenShares > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(numberOfScreenShares + " screen share session(s) (all channels)").appendTo(row);
                      break;
                    case 'webchat':
                      let numberOfChats = usages.media.chats || 0;
                      numberOfChats > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(numberOfChats + " chat(s)").appendTo(row);
                      break;
                    case 'webchat-co-browse':
                      let numberOfChatCoBrowse = usages.media.cobrowses || 0;
                      numberOfChatCoBrowse > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(numberOfChatCoBrowse + " co-browse session(s) (all channels)").appendTo(row);
                      break;
                    case 'webchat-screen-share':
                      let numberOfChatScreenShares = usages.media.screenshares || 0;
                      numberOfChatScreenShares > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(numberOfChatScreenShares + " screen share session(s) (all channels)").appendTo(row);
                      break;
                    case 'wrap-up-codes':
                      let numberOfWrapUpCodes = usages.wrapupcodes || 0;
                      numberOfWrapUpCodes > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(numberOfWrapUpCodes + " wrap-up code(s)").appendTo(row);
                      break;
                    default:
                      break;
                  }
                  break;
                case "outbound-campaigns":
                  switch (item.id) {
                    case 'abandon-rate-configuration':
                      let campaignsWithAbandonRateConfiguration = usages.dialerCampaigns.filter(c => c.hasOwnProperty('abandonRate'));
                      campaignsWithAbandonRateConfiguration.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(campaignsWithAbandonRateConfiguration.length + " campaign(s) with an abandon rate").appendTo(row);
                      break;
                    case 'caller-id-control':
                      let campaignsWithCallerIdControl = usages.dialerCampaigns.filter(c => c.hasOwnProperty('callerAddress') && c.callerAddress);
                      campaignsWithCallerIdControl.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(campaignsWithCallerIdControl.length + " campaign(s) with caller address set").appendTo(row);
                      break;
                    case 'campaign-sequences':
                      let campaignSequences = usages.campaignSequences;
                      campaignSequences.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(campaignSequences.length + " campaign sequence(s)").appendTo(row);
                      break;
                    case 'filtering-for-call-lists':
                      let campaignsWithCallListFilters = usages.dialerCampaigns.filter(c => c.contactListFilters.length > 0);
                      campaignsWithCallListFilters.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(campaignsWithCallListFilters.length + " campaign(s) with contact list filters").appendTo(row);
                      break;
                    case 'multi-level-caller-id-settings':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'outlook-style-schedule-view':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'progress-view':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'callable-times':
                      let callableTimeSets = usages.callableTimeSets;
                      callableTimeSets.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(callableTimeSets.length + " callable time set(s)").appendTo(row);
                      break;
                    case 'dynamic-do-not-call-lists':
                      let dncLists = usages.dncLists;
                      dncLists.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(dncLists.length + " DNC list(s)").appendTo(row);
                      break;
                    case 'multiple-dnc-lists-per-campaign':
                      let campaignsWithMultipleDNCLists = usages.dialerCampaigns.filter(c => c.dncLists.length > 1);
                      campaignsWithMultipleDNCLists.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(campaignsWithMultipleDNCLists.length + " campaign(s) with more than one DNC list").appendTo(row);
                      break;
                    case 'online-dnc.com-integration':
                      let dncListsWithDncDotComIntegration = usages.dncLists.filter(c => c.dncSourceType === 'dnc.com');
                      dncListsWithDncDotComIntegration.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(dncListsWithDncDotComIntegration.length + " DNC list(s) with DNC.com integration").appendTo(row);
                      break;
                    case 'pacing-control-and-overrides':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'time-zone-mapping':
                      let contactListsWithAutomaticTimeZoneMapping = usages.contactLists.filter(c => c.automaticTimeZoneMapping);
                      contactListsWithAutomaticTimeZoneMapping.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(contactListsWithAutomaticTimeZoneMapping.length + " contact list(s) with automatic time zone mapping").appendTo(row);
                      break;
                    case 'time-zone-support':
                      let contactListsWithTimeZoneColumns = usages.contactLists.filter(c => c.phoneColumns.filter(pc => pc.hasOwnProperty('callableTimeColumn')).length > 0);
                      contactListsWithTimeZoneColumns.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(contactListsWithTimeZoneColumns.length + " contact list(s) with a time zone column").appendTo(row);
                      break;
                    default:
                      break;
                  }
                  break;
                case "outbound-dialing":
                  switch (item.id) {
                    case 'advanced-record-processing-rules':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'agentless-auto-messaging':
                      let agentlessCampaigns = usages.dialerCampaigns.filter(c => c.dialingMode === 'agentless');
                      agentlessCampaigns.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(agentlessCampaigns.length + " agentless campaign(s)").appendTo(row);
                      break;
                    case 'answering-machine-detection':
                      let callAnalysisResponseSets = usages.callAnalysisResponseSets.filter(cars => cars.responses.hasOwnProperty('disposition.classification.callable.machine'));
                      callAnalysisResponseSets.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(callAnalysisResponseSets.length + " call analysis response set(s) with answering machine detection").appendTo(row);
                      break;
                    case 'contact-list-management':
                      let contactLists = usages.contactLists;
                      contactLists.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(contactLists.length + " contact list(s)").appendTo(row);
                      break;
                    case 'contact-list-rest-api':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'data-export':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'inbound-outbound-blending':
                      // Would need to find if queues assigned to campaigns also take inbound conversations while the campaign is running. This will take too much processing.
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'outbound-reports':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'power':
                      let powerCampaigns = usages.dialerCampaigns.filter(c => c.dialingMode === 'power');
                      powerCampaigns.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(powerCampaigns.length + " power campaign(s)").appendTo(row);
                      break;
                    case 'predictive':
                      let predictiveCampaigns = usages.dialerCampaigns.filter(c => c.dialingMode === 'predictive');
                      predictiveCampaigns.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(predictiveCampaigns.length + " predictive campaign(s)").appendTo(row);
                      break;
                    case 'preview':
                      let previewCampaigns = usages.dialerCampaigns.filter(c => c.dialingMode === 'preview');
                      previewCampaigns.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(previewCampaigns.length + " preview campaign(s)").appendTo(row);
                      break;
                    case 'priority-preview':
                      // Preview campaigns have a priority of 5 (highest) by default. Actions can be set up to change the priority.
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'progressive':
                      let progressiveCampaigns = usages.dialerCampaigns.filter(c => c.dialingMode === 'progressive');
                      progressiveCampaigns.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(progressiveCampaigns.length + " progressive campaign(s)").appendTo(row);
                      break;
                    case 'scheduled-callbacks':
                      let scheduledCallbacks = usages.media.scheduledCallbacks;
                      scheduledCallbacks > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(scheduledCallbacks + " scheduled callback(s) during the specified timeframe").appendTo(row);
                      break;
                    case 'wrap-up-codes':
                      let numberOfWrapUpCodes = usages.wrapupcodes || 0;
                      numberOfWrapUpCodes > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(numberOfWrapUpCodes + " wrap-up code(s) configured").appendTo(row);
                      break;
                    default:
                      break;
                  }
                  break;
                case "reporting-and-analytics":
                  switch (item.id) {
                    case 'access-to-custom-statistics':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'alerts':
                      // let alerts = usages.interactionStatsRules;
                      // alerts > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      //TODO Requires implicit grant
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'contact-center-dashboard':
                      // Usage not available via API
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'export-dynamic-views':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'flow-performance-views-overview':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'interactions-view':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'intraday-monitoring-and-schedule-adherence-views':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'my-performance-and-my-queue-activity':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'performance-dashboards':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'queues-activity-real-time-views':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'queues-and-agents-performance-view':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'skills-wrap-up-dnis-views':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'agent-activity-summary-report':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'interaction-details':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'queue-metrics':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'queue-wrapup-summary-report':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'scheduled-reports':
                      //TODO Requires implicit grant
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'listen':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'locator-search':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'real-time-dashboard':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    default:
                      break;
                  }
                  break;
                case "security-and-compliance":
                  switch (item.id) {
                    case 'ccpa':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'gdpr':
                      let gdprRequests = usages.gdprRequests;
                      gdprRequests > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(gdprRequests + " current GDPR request(s)").appendTo(row);
                      break;
                    case 'hipaa-compliance':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'pci-dss-with-secure-ivr':
                      let secureIVRFlows = usages.flows.filter(f => f.type === 'securecall');
                      secureIVRFlows.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(secureIVRFlows.length + " secure IVR flow(s)").appendTo(row);
                      break;
                    case 'pci-dss-with-secure-pause':
                      let scriptsWithSecurePauseDefaultAction = usages.scripts.filter(s => {
                        for (var feature in s.features) {
                          if (s.features.hasOwnProperty(feature)) {
                            const currentFeature = s.features[feature];
                            for (const property in currentFeature.properties) {
                              if (currentFeature.properties.hasOwnProperty(property)) {
                                const currentProperty = currentFeature.properties[property];
                                if (currentProperty.typeName === 'action' && currentProperty.value.actionName === 'dialer.securePause') {
                                  return s;
                                }
                              }
                            }
                          }
                        }
                      });
                      scriptsWithSecurePauseDefaultAction.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      let scriptsCol = $("<td/>", { class: "text-center" }).text(scriptsWithSecurePauseDefaultAction.length + " script(s) with secure pause at load").appendTo(row);
                      scriptsCol.html(`${scriptsCol.text()}<br>Secure pause actions are not shown here (too many API calls)`);
                      break;
                    default:
                      break;
                  }
                  break;
                case "speech-enabled-ivr":
                  switch (item.id) {
                    case 'automatic-speech-recognition':
                      let flowsWithASR = usages.flows.filter(f => f.hasOwnProperty('disableAsr') && f.disableAsr.text === "false");
                      flowsWithASR.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(flowsWithASR.length + " flow(s) with ASR").appendTo(row);
                      break;
                    case 'audio-debug-a-call-flow-english':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'dependency-tracking':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'drag-and-drop-auto-attendant':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'email-flows':
                      let emailFlows = usages.flows.filter(f => f.type === "inboundemail");
                      emailFlows.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(emailFlows.length + " email flow(s)").appendTo(row);
                      break;
                    case 'graphical-text-editor':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'inbound-call-flows':
                      let inboundCallFlows = usages.flows.filter(f => f.type === "inboundcall");
                      inboundCallFlows.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(inboundCallFlows.length + " inbound call flow(s)").appendTo(row);
                      break;
                    case 'integrated-prompt-management':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'integrated-speech-enablement':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'native-versioning':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'outbound-call-flows':
                      let outboundCallFlows = usages.flows.filter(f => f.type === "outboundcall");
                      outboundCallFlows.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(outboundCallFlows.length + " outbound call flow(s)").appendTo(row);
                      break;
                    case 'printing-a-call-flow':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'real-time-error-tracking':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'robust-expression-editing':
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'secure-ivr':
                      let secureIvrFlows = usages.flows.filter(f => f.type === "securecall");
                      secureIvrFlows.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(secureIvrFlows.length + " secure IVR flow(s)").appendTo(row);
                      break;
                    case 'text-to-speech':
                      let flowsWithTTS = usages.flows.filter(f => f.manifest.hasOwnProperty('ttsVoice') && f.manifest.ttsVoice.length > 0);
                      flowsWithTTS.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(flowsWithTTS.length + " flow(s) using TTS").appendTo(row);
                      break;
                    default:
                      break;
                  }
                  break;
                case "workforce-optimization":
                  switch (item.id) {
                    case 'agent-evaluator-and-supervisor-access':
                      let evaluations = usages.evaluations;
                      evaluations > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(evaluations + " evaluation(s)").appendTo(row);
                      break;
                    case 'calibration-process':
                      // Requires a calibrator id
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'multiple-question-types':
                      let yesNoQuestions = 0, multipleChoiceQuestions = 0, criticalQuestions = 0, fatalQuestions = 0;
                      usages.evaluationForms.filter(ef => {
                        if (ef.hasOwnProperty('questionGroups')) {
                          for (const questionGroup in ef.questionGroups) {
                            if (ef.questionGroups.hasOwnProperty(questionGroup)) {
                              const currentQuestionGroup = ef.questionGroups[questionGroup];
                              for (const question in currentQuestionGroup.questions) {
                                if (currentQuestionGroup.questions.hasOwnProperty(question)) {
                                  const currentQuestion = currentQuestionGroup.questions[question];
                                  if (currentQuestion.isCritical) criticalQuestions++;
                                  if (currentQuestion.isKill) fatalQuestions++;
                                  if (currentQuestion.type === 'multipleChoiceQuestion') multipleChoiceQuestions++;
                                }
                              }
                            }
                          }
                        }
                      });
                      $("<td/>", { class: "text-center" }).html(`${multipleChoiceQuestions} multiple choice question(s)<br>${criticalQuestions} critical question(s)<br>${fatalQuestions} fatal question(s)<br>Yes/No questions: N/A`).appendTo(row);
                      (yesNoQuestions + multipleChoiceQuestions + criticalQuestions + fatalQuestions) > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      break;
                    case '100-email-recording':
                      let recordedEmails = usages.recordings.emails;
                      recordedEmails > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(recordedEmails + " recorded email(s)").appendTo(row);
                      break;
                    case '100-voice-recording':
                      let recordedCalls = usages.recordings.calls;
                      recordedCalls > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(recordedCalls + " recorded call(s)").appendTo(row);
                      break;
                    case '100-web-chat-recording':
                      let recordedChats = usages.recordings.chats;
                      recordedChats > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(recordedChats + " recorded chat(s)").appendTo(row);
                      break;
                    case 'callback':
                      let callbacks = usages.media.callbacks;
                      callbacks > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(callbacks + " callback(s)").appendTo(row);
                      break;
                    case 'dual-channel-call-recording':
                      let trunks = usages.trunks.filter(t => t.properties.hasOwnProperty('trunk_recording_dualChannel') && t.properties.trunk_recording_dualChannel.value.instance);
                      trunks.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(trunks.length + " trunk(s) with dual-channel call recording turned on").appendTo(row);
                      break;
                    case 'long-term-cloud-storage':
                      let documents = usages.documents;
                      documents > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(documents + " documents(s)").appendTo(row);
                      break;
                    case 'messaging':
                      let messages = sum(usages.media.messages) - (usages.media.messages.hasOwnProperty('sms') ? sum(usages.media.messages.sms) : 0);
                      messages > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(messages + " message(s)").appendTo(row);
                      break;
                    case 'policy-based-recording-retention':
                      let mediaRetentionPolicies = usages.mediaRetentionPolicies.length;
                      mediaRetentionPolicies > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(mediaRetentionPolicies + " media retention polic(y/ies)").appendTo(row);
                      break;
                    case 'recording-audit-trail':
                      // Requires conversation ids. Will take too much time to process.
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'screen-recordings':
                      let screenSessions = usages.screenSessions.length;
                      screenSessions > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(screenSessions + " screen session recording(s)").appendTo(row);
                      break;
                    case 'secure-pause':
                      let scriptsWOWithSecurePauseDefaultAction = usages.scripts.filter(s => {
                        for (var feature in s.features) {
                          if (s.features.hasOwnProperty(feature)) {
                            const currentFeature = s.features[feature];
                            for (const property in currentFeature.properties) {
                              if (currentFeature.properties.hasOwnProperty(property)) {
                                const currentProperty = currentFeature.properties[property];
                                if (currentProperty.typeName === 'action' && currentProperty.value.actionName === 'dialer.securePause') {
                                  return s;
                                }
                              }
                            }
                          }
                        }
                      });
                      scriptsWOWithSecurePauseDefaultAction.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      let scriptsWOCol = $("<td/>", { class: "text-center" }).text(scriptsWOWithSecurePauseDefaultAction.length + " script(s) with secure pause at load").appendTo(row);
                      scriptsWOCol.html(`${scriptsWOCol.text()}<br>Secure pause actions are not shown here (too many API calls)`);
                      break;
                    case 'single-channel-call-recording':
                      let recordedTrunks = usages.trunks.filter(t => t.properties.hasOwnProperty('trunk_recording_enabled') && t.properties.trunk_recording_enabled.value.instance);
                      recordedTrunks.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(recordedTrunks.length + " trunk(s) with recording enabled").appendTo(row);
                      break;
                    case 'sms':
                      let sms = (usages.media.messages.hasOwnProperty('sms') ? sum(usages.media.messages.sms) : 0);
                      sms > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(sms + " sms conversation(s)").appendTo(row);
                      break;
                    case 'multi-channel-post-interaction-web-based-surveys':
                      let surveys = 0;
                      // Use reduce instead?
                      if (usages.surveys) {
                        usages.surveys.forEach((surveyResult) => {
                          surveyResult.data.forEach((data) => {
                            data.metrics.forEach((metric) => {
                              if (metric.metric === 'nSurveysSent') {
                                surveys += metric.stats.count;
                              }
                            });
                          });
                        });
                      }
                      surveys > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).html(`${surveys} survey(s) sent`).appendTo(row);
                      break;
                    default:
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                  }
                  break;
                case "collaboration-and-communication":
                  switch (item.id) {
                    case 'audio-conferencing':
                      let conferences = usages.media.conferences;
                      conferences > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(conferences + " audio conference(s)").appendTo(row);
                      break;
                    case 'call-recording':
                      let recordedCalls = usages.recordings.calls;
                      recordedCalls > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(recordedCalls + " recorded call(s)").appendTo(row);
                      break;
                    case 'chat':
                      let chats = usages.media.chats;
                      chats > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(chats + " chat(s)").appendTo(row);
                      break;
                    case 'cloud-ip-pbx':
                      let calls = usages.media.calls;
                      calls > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(calls + " call(s)").appendTo(row);
                      break;
                    case 'group-ring-hunt-groups':
                      let groupsWithRingHunt = usages.groups.filter(g => g.hasOwnProperty('addresses') && g.addresses.filter(a => a.type === 'GROUPRING').length > 0);
                      groupsWithRingHunt.length > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(groupsWithRingHunt.length + " public group(s) with Group Ring").appendTo(row);
                      break;
                    case 'inbound-outbound-fax':
                      // Can't get the number of faxes due to a bug in the javascript sdk (unknown userId=<clientId>)
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'native-mobile-application':
                      // Can't get the number of mobile devices (is this correct?) due to a bug in the javascript sdk (unknown userId=<clientId>)
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                    case 'video-calling-peer-to-peer':
                    case 'video-calling-multi-user':
                      let videos = usages.media.videos;
                      videos > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(videos + " video(s)").appendTo(row);
                      break;
                    case 'webrtc-softphone':
                      let webRtcStations = usages.stations.hasOwnProperty('inin_webrtc_softphone') ? usages.stations.inin_webrtc_softphone : 0;
                      webRtcStations > 0 ? row.addClass('text-success') : row.addClass('text-danger');
                      $("<td/>", { class: "text-center" }).text(webRtcStations + " WebRTC softphone(s)").appendTo(row);
                      break;
                    default:
                      $("<td/>", { class: "text-center" }).text("N/A").appendTo(row);
                      break;
                  }
                  break;
                default:
                  break;
              }

              // Customer has PC3 and feature is included in PC3? Flash row (text-danger)
              // Customer has PC3 and feature is not included in PC3? Disable row (text-muted bg-light font-italic)

              //TODO Complete this
              if (isUsingPC1 && item.PureCloud1) {
                row.addClass('text-muted bg-light font-italic');
              }
            });
          });
        }

        //#endregion

        //#region Get Data

        async function getData(clientId, clientSecret, environment, startDate, endDate) {

          showSpinner();
          $("#spinner-text").text("Loading... Please Wait...");

          resetValues();

          if (!usages.media) usages = {
            media: {
              calls: 0,
              chats: 0,
              emails: 0,
              callbacks: 0,
              scheduledCallbacks: 0,
              cobrowses: 0,
              videos: 0,
              screenshares: 0,
              conferences: 0,
              messages: {}
            },
            recordings: {
              calls: 0,
              chats: 0,
              emails: 0,
              messages: 0
            },
            flows: []
          };

          // Open web socket and process messages
          const websocket = new WebSocket(webSocketUrl);
          websocket.onmessage = (message) => {

            console.log('Received data from websocket');
            var data = JSON.parse(message.data);

            if (data.hasOwnProperty('media')) {
              $("#spinner-text").text("Receiving media data... ");
              if (data.recordings.hasOwnProperty('status') && data.recordings.status === "FINISHED") {
                allMediaDataReceived = true;
                console.log('No more recordings data...');
                hideCardSpinner("recordingsCard");
              } else {
                usages.media.calls += data.media.calls || 0;
                usages.media.conferences += data.media.conferences || 0;
                usages.media.chats += data.media.chats || 0;
                usages.media.emails += data.media.emails || 0;
                usages.media.callbacks += data.media.callbacks || 0;
                usages.media.scheduledCallbacks += data.media.scheduledCallbacks || 0;
                usages.media.cobrowses += data.media.cobrowses || 0;
                usages.media.videos += data.media.videos || 0;
                usages.media.screenshares += data.media.screenshares || 0;

                if (data.media.messages) {
                  for (let [messageType, numberOfOccurrences] of Object.entries(data.media.messages)) {
                    if (messageType === 'sms') {
                      console.log('Found SMS:', data.media.messages.sms);
                      if (!usages.media.messages.sms) usages.media.messages.sms = {
                        inbound: 0,
                        outbound: 0
                      };
                      usages.media.messages.sms.inbound += data.media.messages.sms.inbound;
                      usages.media.messages.sms.outbound += data.media.messages.sms.outbound;
                      console.log('SMS Usage:', usages.media.messages.sms);
                    } else {
                      if (!usages.media.messages[messageType]) {
                        usages.media.messages[messageType] = 0;
                      }
                      usages.media.messages[messageType] += numberOfOccurrences;
                    }
                  }
                }
              }
            }

            if (data.hasOwnProperty('recordings')) {
              if (data.recordings.hasOwnProperty('status') && data.recordings.status === "FINISHED") {
                allRecordingDataReceived = true;
                console.log('No more recordings data...');
                hideCardSpinner("recordingsCard");
              } else {
                usages.recordings.calls += data.recordings.calls || 0;
                usages.recordings.chats += data.recordings.chats || 0;
                usages.recordings.emails += data.recordings.emails || 0;
                usages.recordings.messages += data.recordings.messages || 0;
              }
            }

            if (data.hasOwnProperty('flow')) {
              $("#spinner-text").text("Receiving flow data...");
              if (data.flow.hasOwnProperty('status') && data.flow.status === "FINISHED") {
                allFlowDataReceived = true;
                console.log('No more flows data...');
                hideCardSpinner("flowsCard");
              } else {
                usages.flows.push(data.flow);
              }
            }

            allDataReceived = allMediaDataReceived && allFlowDataReceived && allRecordingDataReceived;
          };
          websocket.onerror = error => {
            console.error('onerror:', error);
          };
          websocket.onopen = async () => {
            console.log('Websocket opened!');

            // Get Media
            // Call time-dependent functions 7 days at a time (some PureCloud API functions can't accept date range greater than 7 days)
            var dateRanges = getDates(new Date(startDate), new Date(endDate));
            $.each(dateRanges, async (i, dateRange) => {
              console.log(`Current date range: ${dateRange.startDate} to ${dateRange.endDate}`);
              await getMedia(clientId, clientSecret, environment, dateRange.startDate, dateRange.endDate, endDate);
            });

            // Get flows
            await getFlows(clientId, clientSecret, environment);
          };

          // Tasks
          queue.addTask(() => getOrganization(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getBillableUsage(clientId, clientSecret, environment, startDate, endDate), 1000);
          queue.addTask(() => getEvaluations(clientId, clientSecret, environment, startDate, endDate), 1000);
          queue.addTask(() => getSurveys(clientId, clientSecret, environment, startDate, endDate), 1000);
          queue.addTask(() => getScripts(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getQueues(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getContactLists(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getWrapUpCodes(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getStations(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getIntegrations(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getResponseLibraries(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getExternalContacts(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getDialerCampaigns(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getCampaignSequences(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getCallableTimeSets(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getDncLists(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getCallAnalysisResponseSets(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getInteractionStatsRules(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getGDPRRequests(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getEvaluationForms(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getTrunks(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getDocuments(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getMediaRetentionPolicies(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getScreenSessions(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getDivisions(clientId, clientSecret, environment), 1000);
          queue.addTask(() => getGroups(clientId, clientSecret, environment), 1000);

          totalTasks = queue.tasks.length;

          //Wait until all data is received & all tasks are complete
          await until(() => {
            return allDataReceived == true && queue.tasks.length === 0;
          });

          populateLicenses(clientId, clientSecret, environment);

          hideSpinner();
        }

        async function getMedia(clientId, clientSecret, environment, startDate, endDate, originalEndDate) {
          $("#spinner-text").text("Getting Media Usage...");
          return await $.ajax({
            method: 'GET',
            url: `${urlBasePath}/media`,
            contentType: 'application/json',
            dataType: 'text',
            cache: false,
            data: {
              clientId: clientId,
              clientSecret: clientSecret,
              environment: environment,
              startDate: startDate,
              endDate: endDate,
              originalEndDate: originalEndDate,
              uniqueId: uniqueId
            }
          })
            .done((data, textStatus, jqXHR) => {
              try {
                switch (jqXHR.status) {
                  case 200:
                    // Data is received via websocket
                    break;
                  default:
                    console.error(jqXHR);
                    throw new Error(textStatus);
                }
              } catch (error) {
                console.error(error);
                throw error;
              }
            })
            .fail((jqXHR, textStatus, errorThrown) => {
              if (jqXHR.status === 429) {
                console.warn('Got 429 (trunks)');
                $("#spinner-text").text("Too many requests...");
                showMessage('Too many requests (429). Some tasks might be delayed...');
                setTimeout(() => queue.addTask(() => getMedia(clientId, clientSecret, environment, startDate, endDate, originalEndDate), queue.getNextDelay()), 0);
                console.warn('getMedia has been rescheduled');
                resolve();
                return;
              } else {
                console.error(jqXHR);
                console.error(textStatus);
                console.error(errorThrown);
                reject(jqXHR);
              }
            })
            .always(() => {
              console.log("getMedia completed");
            });
        }

        async function getOrganization(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Organization...");
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/organization`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log('Organizations:', jqXHR.responseJSON);
                      usages.organization = jqXHR.responseJSON.organization;
                      if (Object.entries(usages.organization).length === 0) { console.error('No organization information returned!') };

                      $("#title").text("Genesys Cloud Adoption Metrics (" + usages.organization.name + ")");
                      $("#organizationFeaturesBody").empty();
                      for (var feature in usages.organization.features) {
                        if (usages.organization.features.hasOwnProperty(feature)) {
                          let row = $("<tr/>", {}).appendTo("#organizationFeaturesBody");
                          $("<td/>").text(feature).appendTo(row);
                          $("<td/>").text(usages.organization.features[feature]).appendTo(row);
                          row.addClass(usages.organization.features[feature] ? "text-success" : "text-danger");
                        }
                      }
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  if (jqXHR.status === 429) {
                    console.warn('Got 429 (trunks)');
                    $("#spinner-text").text("Too many requests...");
                    setTimeout(() => queue.addTask(() => getOrganization(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                    console.warn('getOrganization has been rescheduled');
                    resolve();
                    return;
                  } else {
                    console.error(jqXHR);
                    console.error(textStatus);
                    console.error(errorThrown);
                    reject(jqXHR);
                  }
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getOrganization(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getOrganization has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getOrganization completed");
              });
          });
        }

        async function getScripts(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Scripts...");
          usages.scripts = [];
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/scripts`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log('Scripts:', jqXHR.responseJSON);
                      usages.scripts = jqXHR.responseJSON.scripts;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getScripts(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getScripts has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getScripts completed");
              });
          });
        }

        async function getQueues(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Queues Usage...");
          usages.queues = [];
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/queues`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log("queues:", jqXHR.responseJSON);
                      let queuesUsage = jqXHR.responseJSON;
                      usages.queues = queuesUsage.queues;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getQueues(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getQueues has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getQueues completed");
              });
          });
        }

        async function getFlows(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Flows...");
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/flows`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment,
                uniqueId: uniqueId
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      // Data is received via websocket
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getFlows(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getFlows has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getFlows completed");
              });
          });
        }

        async function getBillableUsage(clientId, clientSecret, environment, startDate, endDate) {
          $("#spinner-text").text("Getting Billable Usage...");
          usages.licenses = {};
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/billableUsage`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment,
                startDate: startDate,
                endDate: endDate
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      let billableUsageArray = jqXHR.responseJSON;
                      usages.licenses = billableUsageArray.billableUsage;

                      $("#billableUsageBody").empty();
                      for (var billableUsage in billableUsageArray.billableUsage) {
                        if (billableUsageArray.billableUsage.hasOwnProperty(billableUsage)) {
                          let row = $("<tr/>", {}).appendTo("#billableUsageBody");
                          $("<td/>").text(billableUsage).appendTo(row);
                          $("<td/>").text(billableUsageArray.billableUsage[billableUsage]).appendTo(row);
                          setLicensingLevel(billableUsage);
                        }
                      }
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getBillableUsage(clientId, clientSecret, environment, startDate, endDate), queue.getNextDelay()), 0);
                  console.warn('getBillableUsage has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getBillableUsage completed");
              });
          });
        }

        async function getStations(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Stations...");
          usages.stations = {};
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/stations`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.stations = jqXHR.responseJSON.stations;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getStations(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getStations has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getStations completed");
              });
          });
        }

        async function getIntegrations(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Integrations...");
          usages.integrations = {};
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/integrations`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log('Integrations:', jqXHR.responseJSON);
                      usages.integrations = jqXHR.responseJSON.integrations;
                      resolve();
                      break;
                    default:
                      console.error(textStatus);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getIntegrations(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getIntegrations has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getIntegrations completed");
              });
          });
        }

        async function getDialerCampaigns(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Dialer Campaigns...");
          usages.dialerCampaigns = [];
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/dialerCampaigns`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.dialerCampaigns = jqXHR.responseJSON.dialerCampaigns;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getDialerCampaigns(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getDialerCampaigns has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getDialerCampaigns completed");
              });
          });
        }

        async function getContactLists(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Contact Lists...");
          usages.contactLists = [];
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/contactLists`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.contactLists = jqXHR.responseJSON.contactLists;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getContactLists(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getContactLists has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getContactLists completed");
              });
          });
        }

        async function getDocuments(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Documents...");
          usages.documents = 0;
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/documents`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      let documentsUsage = jqXHR.responseJSON;
                      if (documentsUsage.hasOwnProperty('documents')) {
                        let totalDocumentsUsage = 0;
                        $.each(documentsUsage.documents, (i, document) => {
                          if (document.type === "ALL") {
                            totalDocumentsUsage += parseInt(document.totalDocumentCount);
                          }
                        });
                        usages.documents = totalDocumentsUsage;
                      } else {
                        usages.documents = 0;
                      }
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getDocuments(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getDocuments has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getDocuments completed");
              });
          });
        }

        async function getExternalContacts(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting External Contacts...");
          usages.externalContacts = 0;
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/externalContacts`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.externalContacts = jqXHR.responseJSON.externalContacts;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getExternalContacts(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getExternalContacts has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getExternalContacts completed");
              });
          });
        }

        async function getGDPRRequests(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting GDPR Requests...");
          usages.gdprRequests = 0;
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/gdpr`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.gdprRequests = jqXHR.responseJSON.gdprRequests;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getGDPRRequests(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getGDPRRequests has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getGDPRRequests completed");
              });
          });
        }

        async function getEvaluationForms(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Evaluation Forms...");
          usages.evaluationForms = [];
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/evaluationForms`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.evaluationForms = jqXHR.responseJSON.evaluationForms;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getEvaluationForms(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getEvaluationForms has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getEvaluationForms completed");
              });
          });
        }

        async function getResponseLibraries(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Response Libraries...");
          usages.responseLibraries = 0;
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/responseLibraries`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log('Response libraries:', jqXHR.responseJSON);
                      usages.responseLibraries = jqXHR.responseJSON.responseLibraries;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getResponseLibraries(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getResponseLibraries has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getResponseLibraries completed");
              });
          });
        }

        async function getWrapUpCodes(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Wrapup Codes...");
          usages.wrapUpCodes = 0;
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/wrapUpCodes`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.wrapupcodes = jqXHR.responseJSON.wrapUpCodes;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getWrapUpCodes(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getWrapUpCodes has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getWrapUpCodes completed");
              });
          });
        }

        async function getDivisions(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Divisions...");
          usages.divisions = {};
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/divisions`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.divisions = jqXHR.responseJSON.divisions;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getDivisions(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getDivisions has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getDivisions completed");
              });
          });
        }

        async function getCampaignSequences(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Campaign Sequences...");
          usages.campaignSequences = [];
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/campaignSequences`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.campaignSequences = jqXHR.responseJSON.campaignSequences;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getCampaignSequences(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getCampaignSequences has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getCampaignSequences completed");
              });
          });
        }

        async function getCallableTimeSets(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Callable Time Sets...");
          usages.callableTimeSets = [];
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/callableTimeSets`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.callableTimeSets = jqXHR.responseJSON.callableTimeSets;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getCallableTimeSets(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getCallableTimeSets has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getCallableTimeSets completed");
              });
          });
        }

        async function getDncLists(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting DNC Lists...");
          usages.dncLists = [];
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/dncLists`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.dncLists = jqXHR.responseJSON.dncLists;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getDncLists(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getDncLists has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getDncLists completed");
              });
          });
        }

        async function getCallAnalysisResponseSets(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Call Analysis Response Sets...");
          usages.callAnalysisResponseSets = [];
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/callAnalysisResponseSets`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.callAnalysisResponseSets = jqXHR.responseJSON.callAnalysisResponseSets;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getCallAnalysisResponseSets(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getCallAnalysisResponseSets has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getCallAnalysisResponseSets completed");
              });
          });
        }

        async function getInteractionStatsRules(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Interaction Stats Rules...");
          usages.interactionStatsRules = 0;
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/interactionStatsRules`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.interactionStatsRules = jqXHR.responseJSON.interactionStatsRules;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getInteractionStatsRules(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getInteractionStatsRules has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getInteractionStatsRules completed");
              });
          });
        }

        async function getEvaluations(clientId, clientSecret, environment, startDate, endDate) {
          $("#spinner-text").text("Getting Evaluations...");
          usages.evaluations = 0;
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/evaluations`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment,
                startDate: startDate,
                endDate: endDate
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.evaluations = jqXHR.responseJSON.evaluations;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getEvaluations(clientId, clientSecret, environment, startDate, endDate), queue.getNextDelay()), 0);
                  console.warn('getEvaluations has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getEvaluations completed");
              });
          });
        }

        async function getTrunks(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Trunks...");
          usages.trunks = []; // Set default value
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/trunks`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.trunks = jqXHR.responseJSON.trunks;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      reject(jqXHR);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getTrunks(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getTrunks has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getTrunks completed");
              });
          });

        }

        async function getMediaRetentionPolicies(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Media Retention Policies...");
          usages.mediaRetentionPolicies = [];
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/mediaRetentionPolicies`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.mediaRetentionPolicies = jqXHR.responseJSON.mediaRetentionPolicies;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getMediaRetentionPolicies(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getMediaRetentionPolicies has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getMediaRetentionPolicies completed");
              });
          });
        }

        async function getScreenSessions(clientId, clientSecret, environment) {
          $("#spinner-text").text("Getting Screen Sessions...");
          usages.screenSessions = [];
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/screenSessions`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.screenSessions = jqXHR.responseJSON.screenSessions;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getScreenSessions(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getScreenSessions has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getScreenSessions completed");
              });
          });
        }

        async function getSurveys(clientId, clientSecret, environment, startDate, endDate) {
          $("#spinner-text").text("Getting Surveys...");
          usages.surveys = [];
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/surveys`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment,
                startDate: startDate,
                endDate: endDate
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.surveys = jqXHR.responseJSON.surveys;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getSurveys(clientId, clientSecret, environment, startDate, endDate), queue.getNextDelay()), 0);
                  console.warn('getSurveys has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getSurveys completed");
              });
          });
        }

        async function getGroups(clientId, clientSecret, environment) {
          usages.groups = [];
          $("#spinner-text").text("Getting Groups...");
          return new Promise(async (resolve, reject) => {
            $.ajax({
              method: 'GET',
              url: `${urlBasePath}/groups`,
              contentType: 'application/json',
              dataType: 'json',
              data: {
                clientId: clientId,
                clientSecret: clientSecret,
                environment: environment
              }
            })
              .done((data, textStatus, jqXHR) => {
                try {
                  switch (jqXHR.status) {
                    case 200:
                      console.log(jqXHR.responseJSON);
                      usages.groups = jqXHR.responseJSON.groups;
                      resolve();
                      break;
                    default:
                      console.error(jqXHR);
                      throw new Error(textStatus);
                  }
                } catch (error) {
                  console.error(error);
                  throw error;
                }
              })
              .fail((jqXHR, textStatus, errorThrown) => {
                if (jqXHR.status === 429) {
                  console.warn('Got 429 (trunks)');
                  $("#spinner-text").text("Too many requests...");
                  setTimeout(() => queue.addTask(() => getGroups(clientId, clientSecret, environment), queue.getNextDelay()), 0);
                  console.warn('getGroups has been rescheduled');
                  resolve();
                  return;
                } else {
                  console.error(jqXHR);
                  console.error(textStatus);
                  console.error(errorThrown);
                  reject(jqXHR);
                }
              })
              .always(() => {
                console.log("getGroups completed");
              });
          });
        }

        //#endregion

        //#region Print

        $("#generateReport").on("click", () => {
          window.print();
        });

        //#endregion

        //#region Queue Functions

        function TimerQueue() {
          this.currentTimer = null;
          this.tasks = [];
        }

        TimerQueue.prototype.addTask = function (callback, delay) {
          this.tasks.push({ callback: callback, delay: delay });

          // If there's a scheduled task, bail out.
          if (this.currentTimer) return;

          // Otherwise, start kicking tires
          this.launchNextTask();
        };

        TimerQueue.prototype.launchNextTask = function () {

          // If there's a scheduled task, bail out.
          if (this.currentTimer) return;

          var self = this;
          //var nextTask = this.tasks.shift();
          var nextTask = (this.tasks.length > 0 ? this.tasks[0] : undefined);

          // There's no more tasks, clean up.
          if (!nextTask) return this.clear();

          // Otherwise, schedule the next task.
          this.currentTimer = setTimeout(async function () {
            console.log('next task:', nextTask.callback);
            try {
              await nextTask.callback();
            } catch (error) {
              console.error('Error while calling', nextTask.callback, ':', error);
              showErrorMessage('Error', error.responseJSON.message);
            }
            console.log('End of call for next task:', nextTask);
            if (self.tasks.length > 0) self.tasks.shift(); // Remove task from list
            self.currentTimer = null;

            // Call this function again to set up the next task.
            self.launchNextTask();
          }, nextTask.delay);
        };

        TimerQueue.prototype.clear = function () {
          if (this.currentTimer) clearTimeout(this.currentTimer);

          // Timer clears only destroy the timer. It doesn't null references.
          this.currentTimer = null;

          // Fast way to clear the task queue
          this.tasks.length = 0;
        };

        TimerQueue.prototype.getNextDelay = function () {
          console.log(`Getting next delay: Tasks length: ${this.tasks.length}, Last task: ${JSON.stringify(this.tasks[this.tasks.length - 1])}`);
          let longTasks = this.tasks.filter(t => t.delay > 30000);
          if (longTasks && longTasks.length > 0) {
            return 1000;
          }
          return 60000;
        }

        //#endregion

        function sum(obj) {
          var returnSum = 0;
          for (var el in obj) {
            if (obj.hasOwnProperty(el)) {
              if (Object.entries(obj[el]).length > 0) {
                returnSum += sum(obj[el]);
              } else {
                returnSum += parseInt(obj[el]);
              }
            }
          }
          return returnSum;
        }

        function resetValues() {

          isUsingPC1 = false;
          isUsingPC2 = false;
          isUsingPC3 = false;
          isUsingCollaborate = false;
          isUsingCommunicate = false;

          $("#licensesGuideBody").empty();
          $("#licensingLevel").empty();
          $("#billableUsageBody").empty();

          usages = {}, totalTasks = 0, uniqueId = uuidv4();

          // Clear conversations
          $("#totalMediaUsage").text(0);
          $("#totalMediaUsage_calls").text(0);
          $("#totalMediaUsage_chats").text(0);
          $("#totalMediaUsage_emails").text(0);
          $("#totalMediaUsage_callbacks").text(0);
          $("#totalMediaUsage_cobrowses").text(0);
          $("#totalMediaUsage_videos").text(0);
          $("#totalMediaUsage_screenshares").text(0);
          $("#totalMediaUsage_messages").text(0);

          // Clear recordings
          $("#percRecordings").text('0%');
          $("#recordings_progressbar").prop('style', 'width:0%');
          $("#totalRecordingsUsage_calls").text(0);
          $("#totalRecordingsUsage_chats").text(0);
          $("#totalRecordingsUsage_emails").text(0);
          $("#totalRecordingsUsage_messages").text(0);
          $("#calls_recordings").removeClass();
          $("#chats_recordings").removeClass();
          $("#emails_recordings").removeClass();
          $("#messages_recordings").removeClass();
        }

        function sleep(ms) {
          return new Promise(resolve => setTimeout(resolve, ms));
        }

        async function until(fn) {
          while (!fn()) {
            console.log('Waiting... Tasks left:', queue.tasks.length);
            $("#spinner-text").text(`Waiting for next task(s) (${queue.tasks.length}/${totalTasks})`);
            await sleep(1000);
          }
        }

        function uuidv4() {
          return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
            var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
          });
        }

      </script>

      <!-- Coollabs -->
      <script async defer src="https://cdn.coollabs.io/save.js"></script>

</body>

</html>